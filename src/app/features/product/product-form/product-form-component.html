<form [formGroup]="productForm" class="flex flex-col gap-4 p-4 max-w-3xl mx-auto">
    <mat-form-field appearance="fill">
        <mat-label>Product Name</mat-label>
        <input matInput formControlName="name" placeholder="Enter product name" />
        <mat-error *ngIf="productForm.get('name')?.hasError('required')">Name is required</mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill">
        <mat-label>Description</mat-label>
        <textarea matInput rows="3" formControlName="description" placeholder="Enter description"></textarea>
    </mat-form-field>

    <div class="flex items-center justify-between">
        <h3 class="text-lg font-semibold">Variants</h3>
        <button mat-stroked-button color="primary" type="button" (click)="addVariant()">
            <mat-icon>add</mat-icon> Add Variant
        </button>
    </div>

    <div formArrayName="variants" class="space-y-4">
        <div *ngFor="let variant of variants.controls; let i = index" [formGroupName]="i"
            class="grid grid-cols-1 md:grid-cols-4 gap-4 items-end">
            <mat-form-field appearance="fill">
                <mat-label>SKU</mat-label>
                <input matInput formControlName="sku" placeholder="SKU" />
                <mat-error *ngIf="variant.get('sku')?.hasError('required')">SKU is required</mat-error>
            </mat-form-field>

            <mat-form-field appearance="fill">
                <mat-label>Price</mat-label>
                <input matInput type="number" formControlName="price" placeholder="0" />
                <mat-error *ngIf="variant.get('price')?.hasError('min')">Must be >= 0</mat-error>
            </mat-form-field>

            <mat-form-field appearance="fill">
                <mat-label>Stock</mat-label>
                <input matInput type="number" formControlName="stock" placeholder="0" />
                <mat-error *ngIf="variant.get('stock')?.hasError('min')">Must be >= 0</mat-error>
            </mat-form-field>

            <div class="flex gap-2">
                <button mat-stroked-button color="warn" type="button" (click)="removeVariant(i)"
                    [disabled]="variants.length === 1">
                    <mat-icon>remove</mat-icon> Remove
                </button>
            </div>
        </div>
    </div>

    <div class="flex justify-end">
        <button mat-raised-button color="primary" type="button" (click)="submit()">Save Product</button>
    </div>
</form>